<!-- Root container for the full application -->
<div class="app-container">

  <!-- Left panel: visual design toolbox -->
  <div class="design-container">

    <!-- Data Source section -->
    <div class="section">

      <!-- Section header: clickable to toggle visibility -->
      <div class="section-header" (click)="toggleSection('dataSource')">
        <i class="fa fa-database"></i>
        <span>Data Source</span>
      </div>

      <!-- Section content: shown if the section is active -->
      <div *ngIf="activeSections['dataSource']" class="sub-section">
        <div class="option-grid">

          <!-- Render each data source element as a draggable option -->
          <div *ngFor="let element of config.sections.dataSource.elements"
                class="option"
                draggable="true"
                [attr.data-type]="element.type"
                (dragstart)="onDragStart($event, false)">
            <i [class]="element.icon"></i>
            <span>{{element.displayName}}</span>
          </div>
        </div>
      </div>
    </div>

    <!-- Data Processing section -->
    <div class="section">
      <div class="section-header" (click)="toggleSection('dataProcessing')">
        <i class="fa fa-cogs"></i>
        <span>Data Processing</span>
      </div>
      <div *ngIf="activeSections['dataProcessing']" class="sub-section">
        <div class="option-grid">

          <!-- Render each processing element as draggable -->
          <div *ngFor="let element of config.sections.dataProcessing.elements"
                class="option"
                draggable="true"
                [attr.data-type]="element.type"
                (dragstart)="onDragStart($event, false)">
            <i [class]="element.icon"></i>
            <span>{{element.displayName}}</span>
          </div>
        </div>
      </div>
    </div>

    <!-- Data Model section (with nested subcategories) -->
    <div class="section">
      <div class="section-header" (click)="toggleSection('dataModel')">
        <i class="fa fa-project-diagram"></i>
        <span>Data Model</span>
      </div>

      <!-- Only show if dataModel section is active -->
      <div *ngIf="activeSections['dataModel']" class="sub-section">

        <!-- Classification subsection -->
        <div class="sub-category">
          <div class="sub-category-header" (click)="toggleSubSection('classification')">
            <i class="fa fa-check-circle"></i>
            <span>Classification</span>
          </div>
          <div *ngIf="activeSubSections['classification']" class="sub-section">
            <div class="option-grid">
              <div *ngFor="let element of config.sections.dataModel.classification"
                  class="option"
                  draggable="true"
                  [attr.data-type]="element.type"
                  (dragstart)="onDragStart($event, false)">
                <i [class]="element.icon"></i>
                <span>{{element.displayName}}</span>
              </div>
            </div>
          </div>
        </div>

        <!-- Regression subsection-->
        <div class="sub-category">
          <div class="sub-category-header" (click)="toggleSubSection('regression')">
            <i class="fa fa-check-circle"></i>
            <span>Regression</span>
          </div>
          <div *ngIf="activeSubSections['regression']" class="sub-section">
            <div class="option-grid">
              <div *ngFor="let element of config.sections.dataModel.regression"
                  class="option"
                  draggable="true"
                  [attr.data-type]="element.type"
                  (dragstart)="onDragStart($event, false)">
                <i [class]="element.icon"></i>
                <span>{{element.displayName}}</span>
              </div>
            </div>
          </div>
        </div>

        <!-- Anomaly Detection subsection -->
        <div class="sub-category">
          <div class="sub-category-header" (click)="toggleSubSection('anomalyDetection')">
            <i class="fa fa-check-circle"></i>
            <span>Anomaly Detection</span>
          </div>
          <div *ngIf="activeSubSections['anomalyDetection']" class="sub-section">
            <div class="option-grid">
              <div *ngFor="let element of config.sections.dataModel.anomalyDetection"
                  class="option"
                  draggable="true"
                  [attr.data-type]="element.type"
                  (dragstart)="onDragStart($event, false)">
                <i [class]="element.icon"></i>
                <span>{{element.displayName}}</span>
              </div>
            </div>
          </div>
        </div>

        <!-- Explainability subsection -->
        <div class="sub-category">
          <div class="sub-category-header" (click)="toggleSubSection('explainability')">
            <i class="fa fa-check-circle"></i>
            <span>Explainability</span>
          </div>
          <div *ngIf="activeSubSections['explainability']" class="sub-section">
            <div class="option-grid">
              <div *ngFor="let element of config.sections.dataModel.explainability"
                  class="option"
                  draggable="true"
                  [attr.data-type]="element.type"
                  (dragstart)="onDragStart($event, false)">
                <i [class]="element.icon"></i>
                <span>{{element.displayName}}</span>
              </div>
            </div>
          </div>
        </div>
        
        <!-- Monitoring subsection -->
        <div class="sub-category">
          <div class="sub-category-header" (click)="toggleSubSection('monitoring')">
            <i class="fa fa-check-circle"></i>
            <span>Monitoring</span>
          </div>
          <div *ngIf="activeSubSections['monitoring']" class="sub-section">
            <div class="option-grid">
              <div *ngFor="let element of config.sections.dataModel.monitoring"
                  class="option"
                  draggable="true"
                  [attr.data-type]="element.type"
                  (dragstart)="onDragStart($event, false)">
                <i [class]="element.icon"></i>
                <span>{{element.displayName}}</span>
              </div>
            </div>
          </div>
        </div>
      </div>
    </div>     
  </div>

  <!-- Central canvas workspace where elements are dropped -->
  <div class="workspace" >
    <div id="drop-area" #dropArea
        class="drop-area" 
        (dragover)="onDragOver($event)" 
        (drop)="onDrop($event)">
    </div>
    <div id="selection-box"></div>
  </div>

  <!-- Right-side panel for configuration of selected nodes -->
  <div #configContainer class="config-container">

    <!-- Close config panel button -->
    <button class="close-btn" (click)="closeConfig()">X</button>

    <!-- Dynamic configuration content gets injected here -->
    <div class="config-content">
    </div>
  </div> 
</div>