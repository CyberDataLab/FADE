<!-- Button options section (visible only on root sub-routes) -->
 <div class="options-container" *ngIf="isRootSubRoute()">

  <!-- Button to create a new scenario -->
  <button class="new-button new-scenario" (click)="newScenario()">
    <i class="fas fa-plus"></i>
    <span class="tooltip-text">Click to design a new scenario</span>
  </button>

  <!-- Button to trigger file input for importing a scenario -->
  <button class="import-button load-scenario" (click)="triggerFileInput()">
    ðŸ“‚
    <span class="tooltip-text">Click to import an existing scenario. Please select the JSON and data files</span>
  </button>

  <!-- Hidden file input for importing scenario files -->
  <input type="file" id="fileInput" style="display: none;" (change)="loadScenario($event)" accept=".json, .csv, .pcap" multiple>
</div>

<!-- Main content section -->
<div class="content">

  <!-- Table of available scenarios (only on root sub-routes) -->
  <div class="table-container" *ngIf="isRootSubRoute()">
    <table class="scenario-table">
      <thead>
        <tr>
          <th>ID</th>
          <th>Name</th>
          <th>Status</th>
          <th>Date</th>
          <th>Actions</th>
        </tr>
      </thead>
      <tbody>

        <!-- Loop through all scenarios and display their details -->
        <tr *ngFor="let scenario of scenarios">
          <td>{{ scenario.uuid }}</td>
          <td>{{ scenario.name }}</td>

          <!-- Conditionally styled status column -->
          <td [class.finished]="scenario.status === 'Finished'" [class.error]="scenario.status === 'Error'">{{ scenario.status }}</td>
          
          <!-- Formatted date -->
          <td>{{ scenario.date | date:'dd/MM/yyyy HH:mm:ss' }}</td>

          <!-- Scenario action buttons -->
          <td>
            <div class="action-buttons">

              <!-- Edit scenario -->
              <button class="default-button edit-button" (click)="editScenario(scenario.uuid)" title="Edit">
                <i class="fas fa-pencil-alt"></i>
              </button>

              <!-- Download scenario -->
              <button class="default-button" (click)="downloadScenario(scenario)" title="Download">
                <i class="fas fa-download"></i>
              </button>

              <!-- Run scenario -->
              <button class="default-button" (click)="runScenario(scenario.status, scenario.uuid)" title="Run">
                <i class="fas fa-play"></i>
              </button>

              <!-- View Timeline for Anomaly Detection (if finished and AD is present) -->
              <button class="default-button" *ngIf="scenario.status === 'Finished' && hasAnomalyDetection(scenario)" (click)="viewTimelineAD(scenario.uuid)" title="Timeline AD">
                <i class="fas fa-chart-line"></i>
              </button>

              <!-- Deploy scenario to production (if finished and AD is present) -->
              <button class="default-button" *ngIf="scenario.status === 'Finished' && hasAnomalyDetection(scenario)" (click)="production(scenario.uuid)" title="Production AD">
              <i class="fa-solid fa-cloud-arrow-up"></i>
              </button>
              
              <!-- View metrics (if finished and model is classification or regression) -->
              <button class="default-button" *ngIf="scenario.status === 'Finished' && hasClassificationOrRegression(scenario)" (click)="viewMetrics(scenario.uuid)" title="Metrics">
                <i class="fas fa-chart-bar"></i>
              </button>

              <!-- Delete scenario -->
              <button class="default-button delete-button" (click)="deleteScenario(scenario.uuid)" title="Delete">
                <i class="fas fa-trash-alt"></i>
              </button>
            </div>
          </td>
        </tr>

        <!-- Show empty message when no scenarios exist -->
        <tr *ngIf="scenarios.length === 0">
          <td colspan="5" class="empty-row">No scenarios available</td>
        </tr>
      </tbody>
    </table>
  </div>

  <!-- Dynamic routing outlet (e.g. for edit, run, view pages) -->
  <router-outlet></router-outlet>
</div>